================================================================================
              E4L DevOps Platform - Complete Architecture Diagram
================================================================================

This document provides detailed architecture diagrams showing all three
environments: Development (Local), Staging, and Production.


================================================================================
                        FULL SYSTEM ARCHITECTURE
================================================================================

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              HOST MACHINE                                       │
│                                                                                 │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                      DEV ENVIRONMENT (Local)                              │  │
│  │                                                                           │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐     │  │
│  │   │                    Developer Workstation                        │     │  │
│  │   │                                                                 │     │  │
│  │   │   ┌──────────────────┐      ┌──────────────────┐                │     │  │
│  │   │   │   IDE / Editor   │      │   Git CLI        │                │     │  │
│  │   │   │   (VS Code)      │      │   (Local Repo)   │                │     │  │
│  │   │   └────────┬─────────┘      └────────┬─────────┘                │     │  │
│  │   │            │                         │                          │     │  │
│  │   │            ▼                         ▼                          │     │  │
│  │   │   ┌──────────────────────────────────────────────┐              │     │  │
│  │   │   │            Local Development                 │              │     │  │
│  │   │   │                                              │              │     │  │
│  │   │   │  ┌────────────────┐  ┌────────────────┐      │              │     │  │
│  │   │   │  │ Backend Dev    │  │ Frontend Dev   │      │              │     │  │
│  │   │   │  │ (Gradle/Java)  │  │ (npm/Webpack)  │      │              │     │  │
│  │   │   │  │ localhost:8080 │  │ localhost:3000 │      │              │     │  │
│  │   │   │  └────────────────┘  └────────────────┘      │              │     │  │
│  │   │   │            │                  │              │              │     │  │
│  │   │   │            ▼                  ▼              │              │     │  │
│  │   │   │  ┌────────────────────────────────────┐      │              │     │  │
│  │   │   │  │    Local Unit Tests                │      │              │     │  │
│  │   │   │  │  • JUnit (Backend)                 │      │              │     │  │
│  │   │   │  │  • Jest (Frontend)                 │      │              │     │  │
│  │   │   │  └────────────────────────────────────┘      │              │     │  │
│  │   │   └──────────────────────────────────────────────┘              │     │  │
│  │   └─────────────────────────────────────────────────────────────────┘     │  │
│  │                              │                                            │  │
│  │                              │ git push                                   │  │
│  │                              ▼                                            │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                   INTEGRATION ENVIRONMENT (GitLab)                        │  │
│  │                                                                           │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐     │  │
│  │   │                GITLAB CE (localhost:8929)                       │     │  │
│  │   │                                                                 │     │  │
│  │   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐      │     │  │
│  │   │  │   Backend   │  │  Frontend   │  │  Docker Registry    │      │     │  │
│  │   │  │    Repo     │  │    Repo     │  │  (localhost:5050)   │      │     │  │
│  │   │  └──────┬──────┘  └──────┬──────┘  └─────────────────────┘      │     │  │
│  │   │         │                │                    ▲                 │     │  │
│  │   │         └────────┬───────┘                    │                 │     │  │
│  │   │                  ▼                            │                 │     │  │
│  │   │         ┌─────────────────┐                   │                 │     │  │
│  │   │         │  GitLab Runner  │───────────────────┘                 │     │  │
│  │   │         │(Docker executor)│   pushes images                     │     │  │
│  │   │         └────────┬────────┘                                     │     │  │
│  │   │                  │                                              │     │  │
│  │   │                  │ CI/CD Pipeline                               │     │  │
│  │   │                  ▼                                              │     │  │
│  │   │  ┌──────────────────────────────────────────────────────────┐   │     │  │
│  │   │  │              PIPELINE STAGES                             │   │     │  │
│  │   │  │                                                          │   │     │  │
│  │   │  │  ┌───────┐  ┌───────┐  ┌─────────┐  ┌────────────────┐   │   │     │  │
│  │   │  │  │ BUILD │─►│ TEST  │─►│ PACKAGE │─►│ DEPLOY STAGING │   │   │     │  │
│  │   │  │  └───────┘  └───────┘  └─────────┘  └───────┬────────┘   │   │     │  │
│  │   │  │                                             │            │   │     │  │
│  │   │  │                                             ▼            │   │     │  │
│  │   │  │                              ┌─────────────────────────┐ │   │     │  │
│  │   │  │                              │  E2E TESTS (Staging)    │ │   │     │  │
│  │   │  │                              │  • Newman/Postman       │ │   │     │  │
│  │   │  │                              │  • Puppeteer            │ │   │     │  │
│  │   │  │                              └────────────┬────────────┘ │   │     │  │
│  │   │  │                                           │              │   │     │  │
│  │   │  │                                           ▼              │   │     │  │
│  │   │  │                              ┌─────────────────────────┐ │   │     │  │
│  │   │  │                              │   DEPLOY PRODUCTION     │ │   │     │  │
│  │   │  │                              └─────────────────────────┘ │   │     │  │
│  │   │  └──────────────────────────────────────────────────────────┘   │     │  │
│  │   └─────────────────────────────────────────────────────────────────┘     │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                      SHARED DOCKER NETWORK (e4l-db-net)                   │  │
│  │                                                                           │  │
│  │  ┌──────────────────────────────────┐  ┌──────────────────────────────┐   │  │
│  │  │        STAGING ENVIRONMENT       │  │      PRODUCTION ENVIRONMENT  │   │  │
│  │  │                                  │  │                              │   │  │
│  │  │  Purpose: Integration Testing,   │  │  Purpose: Live Application,  │   │  │
│  │  │  E2E Testing, QA Validation      │  │  End Users Access            │   │  │
│  │  │                                  │  │                              │   │  │
│  │  │  ┌────────────────────────────┐  │  │  ┌────────────────────────┐  │   │  │
│  │  │  │     Frontend Container     │  │  │  │   Frontend Container   │  │   │  │
│  │  │  │  ┌──────────────────────┐  │  │  │  │  ┌──────────────────┐  │  │   │  │
│  │  │  │  │   Nginx + React      │  │  │  │  │  │  Nginx + React   │  │  │   │  │
│  │  │  │  │   localhost:8881     │  │  │  │  │  │  localhost:8882  │  │  │   │  │
│  │  │  │  └──────────────────────┘  │  │  │  │  └──────────────────┘  │  │   │  │
│  │  │  └─────────────┬──────────────┘  │  │  └───────────┬────────────┘  │   │  │
│  │  │                │ API calls       │  │              │ API calls     │   │  │
│  │  │                ▼                 │  │              ▼               │   │  │
│  │  │  ┌────────────────────────────┐  │  │  ┌────────────────────────┐  │   │  │
│  │  │  │     Backend Container      │  │  │  │   Backend Container    │  │   │  │
│  │  │  │  ┌──────────────────────┐  │  │  │  │  ┌──────────────────┐  │  │   │  │
│  │  │  │  │   Spring Boot API    │  │  │  │  │  │  Spring Boot API │  │  │   │  │
│  │  │  │  │   localhost:8084     │  │  │  │  │  │  localhost:8085  │  │  │   │  │
│  │  │  │  └──────────────────────┘  │  │  │  │  └──────────────────┘  │  │   │  │
│  │  │  └─────────────┬──────────────┘  │  │  └───────────┬────────────┘  │   │  │
│  │  │                │ DB queries      │  │              │ DB queries    │   │  │
│  │  │                ▼                 │  │              ▼               │   │  │
│  │  │  ┌────────────────────────────┐  │  │  ┌────────────────────────┐  │   │  │
│  │  │  │     Database Container     │  │  │  │   Database Container   │  │   │  │
│  │  │  │  ┌──────────────────────┐  │  │  │  │  ┌──────────────────┐  │  │   │  │
│  │  │  │  │   MariaDB            │  │  │  │  │  │   MariaDB        │  │  │   │  │
│  │  │  │  │   Database: e4l_stg  │  │  │  │  │  │   Database:      │  │  │   │  │
│  │  │  │  │   Port: 3307         │  │  │  │  │  │   e4l_prod       │  │  │   │  │
│  │  │  │  └──────────────────────┘  │  │  │  │  │   Port: 3308     │  │  │   │  │
│  │  │  └────────────────────────────┘  │  │  │  └──────────────────┘  │  │   │  │
│  │  │                                  │  │  └────────────────────────┘  │   │  │
│  │  └──────────────────────────────────┘  └──────────────────────────────┘   │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘


================================================================================
                      ENVIRONMENT COMPARISON MATRIX
================================================================================

┌────────────────┬─────────────────────┬─────────────────────┬─────────────────────┐
│   Component    │   DEV (Local)       │   STAGING           │   PRODUCTION        │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Purpose        │ Development &       │ Integration Testing │ Live Application    │
│                │ Local Testing       │ E2E Testing & QA    │ End User Access     │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Frontend       │ localhost:3000      │ localhost:8881      │ localhost:8882      │
│                │ (webpack dev)       │ (Nginx + React)     │ (Nginx + React)     │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Backend        │ localhost:8080      │ localhost:8084      │ localhost:8085      │
│                │ (Gradle bootRun)    │ (Docker Container)  │ (Docker Container)  │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Database       │ localhost:3306      │ e4l_stg (3307)      │ e4l_prod (3308)     │
│                │ (Local/Docker)      │ (Docker Container)  │ (Docker Container)  │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Testing        │ Unit Tests          │ E2E Tests           │ Smoke Tests         │
│                │ • JUnit             │ • Newman/Postman    │ (Post-deploy)       │
│                │ • Jest              │ • Puppeteer         │                     │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Deployment     │ Manual              │ Automatic           │ Automatic           │
│ Method         │ (gradle/npm)        │ (CI/CD Pipeline)    │ (CI/CD Pipeline)    │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Data           │ Developer Test Data │ Test/Seeded Data    │ Production Data     │
├────────────────┼─────────────────────┼─────────────────────┼─────────────────────┤
│ Isolation      │ Developer Machine   │ Docker Network      │ Docker Network      │
│                │                     │ (Isolated)          │ (Isolated)          │
└────────────────┴─────────────────────┴─────────────────────┴─────────────────────┘


================================================================================
                        DATA FLOW & DEPLOYMENT PATH
================================================================================

                           CODE JOURNEY THROUGH ENVIRONMENTS
                           
    ┌───────────────────────────────────────────────────────────────────────────┐
    │                                                                           │
    │   DEVELOPER                                                               │
    │   WORKSTATION                                                             │
    │   (DEV ENV)                                                               │
    │                                                                           │
    │   ┌─────────┐     ┌─────────┐     ┌─────────┐                             │
    │   │  Code   │────►│  Test   │────►│  Commit │                             │
    │   │  Edit   │     │  Local  │     │  Code   │                             │
    │   └─────────┘     └─────────┘     └────┬────┘                             │
    │                                        │                                  │
    └────────────────────────────────────────┼──────────────────────────────────┘
                                             │
                                             │ git push
                                             ▼
    ┌───────────────────────────────────────────────────────────────────────────┐
    │                                                                           │
    │   GITLAB CI/CD                                                            │
    │   (INTEGRATION)                                                           │
    │                                                                           │
    │   ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────────────┐     │
    │   │  BUILD  │────►│  TEST   │────►│ PACKAGE │────►│ PUSH TO         │     │
    │   │         │     │  (Unit/ │     │ (Docker │     │ REGISTRY        │     │
    │   │         │     │  Integ) │     │  Image) │     │ localhost:5050  │     │
    │   └─────────┘     └─────────┘     └─────────┘     └────────┬────────┘     │
    │                                                            │              │
    └────────────────────────────────────────────────────────────┼──────────────┘
                                                                 │
                                                                 │ docker pull
                                                                 ▼
    ┌───────────────────────────────────────────────────────────────────────────┐
    │                                                                           │
    │   STAGING ENVIRONMENT                                                     │
    │                                                                           │
    │   ┌─────────────┐     ┌─────────────┐     ┌─────────────────────────┐     │
    │   │   DEPLOY    │────►│  RUN E2E    │────►│  TESTS PASS?            │     │
    │   │  (Pull &    │     │   TESTS     │     │                         │     │
    │   │   Run)      │     │ (Postman/   │     │  YES ──────────────┐    │     │
    │   │             │     │  Puppeteer) │     │                    │    │     │
    │   │ :8881/:8084 │     └─────────────┘     │  NO ───► STOP ✗    │    │     │
    │   └─────────────┘                         └─────────────────────┼───┘     │
    │                                                                 │         │
    └─────────────────────────────────────────────────────────────────┼─────────┘
                                                                      │
                                                                      │ Promote
                                                                      ▼
    ┌───────────────────────────────────────────────────────────────────────────┐
    │                                                                           │
    │   PRODUCTION ENVIRONMENT                                                  │
    │                                                                           │
    │   ┌─────────────┐     ┌─────────────┐                                     │
    │   │   DEPLOY    │────►│   LIVE      │                                     │
    │   │  (Pull &    │     │   APP       │                                     │
    │   │   Run)      │     │   ✓         │                                     │
    │   │             │     │             │                                     │
    │   │ :8882/:8085 │     │             │                                     │
    │   └─────────────┘     └─────────────┘                                     │
    │                                                                           │
    └───────────────────────────────────────────────────────────────────────────┘


================================================================================
                        NETWORK & PORT ALLOCATION
================================================================================

    EXTERNAL ACCESS (Host Machine)
    ══════════════════════════════════════════════════════════════════════════
    
    Port 8929  ──────────►  GitLab Web UI
    Port 5050  ──────────►  Docker Registry
    
    Port 8881  ──────────►  Staging Frontend  (Nginx)
    Port 8084  ──────────►  Staging Backend   (Spring Boot)
    
    Port 8882  ──────────►  Production Frontend (Nginx)
    Port 8085  ──────────►  Production Backend  (Spring Boot)
    
    
    INTERNAL DOCKER NETWORK (e4l-db-net)
    ══════════════════════════════════════════════════════════════════════════
    
    ┌─────────────────────────────────────────────────────────────────────────┐
    │                                                                         │
    │   ┌───────────────┐          ┌───────────────┐                          │
    │   │  stg-frontend │◄────────►│ prod-frontend │                          │
    │   └───────┬───────┘          └───────┬───────┘                          │
    │           │                          │                                  │
    │           │ internal:80              │ internal:80                      │
    │           │                          │                                  │
    │           ▼                          ▼                                  │
    │   ┌───────────────┐          ┌───────────────┐                          │
    │   │  stg-backend  │          │ prod-backend  │                          │
    │   └───────┬───────┘          └───────┬───────┘                          │
    │           │                          │                                  │
    │           │ internal:8080            │ internal:8080                    │
    │           │                          │                                  │
    │           ▼                          ▼                                  │
    │   ┌───────────────┐          ┌───────────────┐                          │
    │   │   stg-db      │          │   prod-db     │                          │
    │   │  (MariaDB)    │          │  (MariaDB)    │                          │
    │   └───────────────┘          └───────────────┘                          │
    │                                                                         │
    └─────────────────────────────────────────────────────────────────────────┘


================================================================================
                     ENVIRONMENT ISOLATION DIAGRAM
================================================================================

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                          ISOLATION BOUNDARIES                           │
    │                                                                         │
    │  ╔═══════════════════════════════════════════════════════════════════╗  │
    │  ║  DEV ENVIRONMENT                                                  ║  │
    │  ║  ═══════════════                                                  ║  │
    │  ║  • Runs on developer's local machine                              ║  │
    │  ║  • Uses local filesystem for source code                          ║  │
    │  ║  • Can use local or containerized database                        ║  │
    │  ║  • Changes do NOT affect Staging or Production                    ║  │
    │  ║  • Developer has full control                                     ║  │
    │  ╚═══════════════════════════════════════════════════════════════════╝  │
    │                              │                                          │
    │                              │ git push (code only)                     │
    │                              ▼                                          │
    │  ╔═══════════════════════════════════════════════════════════════════╗  │
    │  ║  STAGING ENVIRONMENT                                              ║  │
    │  ║  ═══════════════════                                              ║  │
    │  ║  • Separate Docker containers                                     ║  │
    │  ║  • Own database instance (e4l_stg)                                ║  │
    │  ║  • Own network ports (8881, 8084, 3307)                           ║  │
    │  ║  • Test data only - safe to reset/modify                          ║  │
    │  ║  • E2E tests run here before promotion                            ║  │
    │  ║  • Changes do NOT affect Production                               ║  │
    │  ╚═══════════════════════════════════════════════════════════════════╝  │
    │                              │                                          │
    │                              │ E2E tests pass → promote                 │
    │                              ▼                                          │
    │  ╔═══════════════════════════════════════════════════════════════════╗  │
    │  ║  PRODUCTION ENVIRONMENT                                           ║  │
    │  ║  ══════════════════════                                           ║  │
    │  ║  • Separate Docker containers                                     ║  │
    │  ║  • Own database instance (e4l_prod)                               ║  │
    │  ║  • Own network ports (8882, 8085, 3308)                           ║  │
    │  ║  • Production data - handle with care                             ║  │
    │  ║  • Only receives verified, tested code                            ║  │
    │  ║  • Rollback possible via Docker image tags                        ║  │
    │  ╚═══════════════════════════════════════════════════════════════════╝  │
    │                                                                         │
    └─────────────────────────────────────────────────────────────────────────┘


================================================================================
                            ACCESS SUMMARY
================================================================================

  DEVELOPMENT (Local Machine):
    Frontend:    localhost:3000  (webpack dev server)
    Backend:     localhost:8080  (gradle bootRun)
    Database:    localhost:3306  (local MariaDB/MySQL)
    
  INTEGRATION (GitLab):
    GitLab UI:   http://localhost:8929
    Registry:    http://localhost:5050
    Credentials: testdev / vx6Yo1Mnmn4q7D4Q

  STAGING:
    Frontend:    http://localhost:8881
    Backend:     http://localhost:8084
    Database:    MariaDB on port 3307 (internal)

  PRODUCTION:
    Frontend:    http://localhost:8882
    Backend:     http://localhost:8085
    Database:    MariaDB on port 3308 (internal)

================================================================================
